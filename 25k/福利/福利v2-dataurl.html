<html>
<head>
<title>金毛发福利了！</title>
<meta name="viewport" content="initial-scale=0.75, maximum-scale=0.75 ,minimum-scale=0.75, user-scalable=0">
<style type="text/css">
.bar-border {
	display: inline-block;
	width: 200px;
	height: 5px;
	border: 1px solid;
}
.gmbutton {
	border: 1px solid;
}
.gm-gold {
	background-color: #FFD700;
}
.gm-silver {
	background-color: #C0C0C0;
}
#bar {
	background-color: black;
	height: 5px;
	width: 0px;
}
.float {
	position: absolute;
	border: 1px solid;
	background-color: white;
	z-index: 100;
}
.float-title {
	user-select:none;
	background-color: gray;
	color: white;
}
#inv {
	width: 250px;
	min-height: 250px;
}
.maptitle {
	background-color: yellow;
	color: black;
}
#map {
	width: 256px;
	height: 256px;
	background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACABAMAAAAxEHz4AAAAG1BMVEX///9/f38AAADv5LC5eleIABX/fyftHCQAoujoN7NaAAAEs0lEQVRo3uyWTY7iQAyFLTto+hilYjFbC3OASHAANBIX6AVX6CvMsefZ5qcqJAyw5uW3lfKXZ5dTDX300UcfffSeuJbFRxyX8ii41rI8oDigQmU5GHoEwJDSjeAa555aW7WvKIUDUtusclQnpkbt80ocnJmxPWA5BWbEVy7vA5D+hou+CcgarCu3Y7N6BxwrbDg/AmQNWCvRcAH8/imrI3Q4umYA3AIQWUslITK7AjoHjuJb/c+T0EuxD6NqluUHgHAASGIA+PrbvnYqU9O9iOgVcFgdcRCyOAOY+/7sJHAvO3NldwMAwcaKsN0AHKH4YxoP8zuFCzJLAKIO2MBZoRoBSONzn44hUIbR4ANHAlaHKB/OfqHDnwbAEwuGjUQ9C1F4CEAEI3vf4cMBpwugdA48zkj9UMFFQc/nMAGIZ4L7BHC6Z+Zb9s4Qc6nhTowXFp56dcDevd0MmMpOBAZUzTYLgF9f2bV12gfwoFswQHGSLjnwUE9v2gdiQET5ldQpS4DT6RuhnLPQdQDid2oQiXoN6jKgMNfwcXXgvsWGXVQivSjPrbA1HQDUdoFZTsF+VMEla0Cc09WrA+Bx0wZbGzTmLzvCEs/ZMs3ae/quVwBxN4uaGaip56AzgFy5KcILlUknj0aIDBJOS4BLCzEATQoC0/szIAim8gBQqZSuiiSq0YjRRmou2swAuCwsR4awvSqpSUwoCdH6HlDbnGsHUBmGcK5+ci9zAGR9JwohYPA59PeTuQVlmgEs/Y8RUhoTENUQ7A8A5Q6gQjIO5uYpKym0eQEgiAJgC/83taP4PwCDAaEAkISUdP08wBQWhlwMSTQz2dQZzQNMnDASALjNb0ni+VQ8B40uBsIBOxOgTAkOqDz74yB9b+PORMhpIs8DIH/jGZDfEa6vAKL7NUCRgBmA+grAFDqj8mt2D88C0viQAG/p6GOylxyY/mvHjnIbB4EwACObC9jiAHi0B0DaPYDZcv8zdYbfhaGllgkPfenvqFUk82VmEmEnAAyAkLe1pwA6OC9ADuwI60MAu9k/A4ALCQzKMIZaWAFwBFiDDEMPkTgt0FwYZQ+owGoEYMfXz26+1SgAIbi1BBAK8CZroXh1+WwAj+4U8NcUYBUgb6lmAAi2ADZIBeEF4IrF+lHgLIB5E2C0BWsqYHl5B1iwyDeA/wZYTQH8oiooqP/SQgPIcxMuwPSAzy3YBpA3chSQ89UUkQHgvJyUTtQzCFiDpMSPdA8sN0CSnDKEPkA9wNcObMqR50EDvnyxrQBQWd4HdAWL/zhZAWQQAqA6QA8NYK5QBdRdYwsgGlg8ffotIFO+qA1w5gos91CBem6dAVBEAZbXYggaoAcpwNVG1Tu/hyzopRd7ApD/99s40D7CwP9Eg1E79Z/E2UaTV29IkgwD8kcDcRKIaQJwKGAGEGEKqHltBjrTQJwEYpoF3E8DycU5wG2TwBbdMOAawM0BXH+MrwB50TQAwU0AjmeggWMcwAR3omMj4sdDYEubBvDix74f+ygQU1nOAB8zANF+PGwhfgGISAzOHaCjAeQ4Hg9RpxbA4TGMA7qCg+h1gPi4qYCoB4xdm5c8aZWdzHAWjXrzm8G8Ax99jpU0mlf7AAAAAElFTkSuQmCC");
	background-size:100% 100%;
	background-repeat:no-repeat;
}
.scene{
	position: relative;
}
#medi-store {
	width: 512px;
	height: 512px;
	background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACAAgMAAAC+UIlYAAAADFBMVEX///9/f38AAAD/fycL88kIAAAClElEQVRYw+3WQW6cMBQG4N8xbKqRoAtfIiu6n2qcRfdE4vUiVfc5SpcjcgmrUXeteo+uOMBI0zd+GMaAHVWVsppfKIl5H2DeBA+4ZUxJ1CIT6gBDdhommPGn4tguIbjmS62i6OrTyM6/KcTPbQ18VBjPQFEEMMe0vK2AVK4BuhQo7WWzJdkI+EroFG+2wArIjftSsQJS2QZuE7QTOG+Dmn/q8wBbuQzAAXaPDHD6fG48gN0CcJXDkAKXRg0nYK+dfPYCpkYZ4nxxQKUNAXigMZCUvu0HAPrX1DCJuK4GpwLnBAGLeKAdgCYHwNlP4zlkr86wWwBFEyg7d1H+iBgYoC67EcDFAB2b1gPVBmAwA+6g4mGtWhgaBPARMyggwBCjZgSoV6CtFYM9AO1BsQTWg51vZwZoQA9ZMOgzcgCHE2JgFkA1AYQeeECtwgIoX24FhV2G6FEAPRLn+nH2VT6g/EqSx/g/ioGsD2UDiYo+TUWkOhltA7Kqk9VCDyuAzgMr4OMpAuFWDWBlOfnwewWkD7ByUz9eAli12j9nunAuC6rCNVlwKtw+BypXuCoHdiichk8fEoEGxffncX9IDO76I9zqK2sGf45ghVWkUZ/7ZydPd5w+5AiZX3UekIi/Q2bJ7IQ5JKJ/ws8hCQ5y7aZJgXF9G3ZJ8IJ8tHOvAAx4JQ3eLnf9lO3iMXNsrvguf2zff8u+GoXZGCILqOU3xn2oowBi0Ps8IQVC/hGUdFnnuq23LZ7jJ64CtWUbokZdQxXAA/D+Cvjb5UES1GnQJYFq/VV5SjGY58hV3sXeg6DDCeT6E+AiZJAA/EcamA1QUpwAzOotNMSWYX8iXLrllv/O/XIZ7Bd5Wq6MSOYJ90fkcjnbLW+Rv+vM/t4li0xXAAAAAElFTkSuQmCC");
	background-size:100% 100%;
	background-repeat:no-repeat;
}
#medispeak{
	position: absolute;
	left: 308px;
	top: 100px;
	background-color: orange;
	font-size: 20px;
	border: 2px solid orange;
	border-radius: 10px;
}
.medi-options{
	font-size: 18px;
}
#rest-store {
	width: 512px;
	height: 512px;
	background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACABAMAAAAxEHz4AAAAD1BMVEX///8AAAC5eld/f3/Dw8Ot5wEJAAADMElEQVRo3ryUAQ4bIQwEvSIP2P0JEh9opfz/TcXGV6KmCgepuoRAlPPc2ljYB6GPYyVgMJA/SVESIZkRfS4AhEEy+fPqg13JMgcZ9QmRL6ERsSIBIxh0pK0BokmcAEhRHDoES0DUIN7rYUoHFImwtwS4wghkLznDJ+2WAxnAmezIH+7G97BVDb7RrAFG5pmA6MP/uHWMwFVE5mr0bfSBuARAHJkwNHyI4xSERY5Cn87QK2B8KFs7gIsIB8ouUDIkUcIS4FNyG6NkUBbx6vMlQNk3NNdcJRJrB/Z3uafUEkDziXSLKwFT6jNAkMacd0K0xV0JRngEzAGxcg+ATIOcl8qug7DPkcI+YLRCoGYP7AB80mR8uRO0AXg/F2kjHgDJyD/vAdiWACPSsozjKB5P130HswcU+6HHbQeSrh7gCQAROy6WQ4AiMntgFyCYMGb2wCaAetMmwN50AHj8O0CruZ4Camk9trRyCvBoK9U64HkEKNa6fLUfZ4BSzR2cA1okcgqIWFdtx4Ayvut/Bjz/BNge4PXZ+iWgfAtodlSDnwpNA8VOHDhgGtkA5CmCF6C0egJQ5J7hBwAovHdVOwIIljoDgN8BQDsEKADoC+aNsANAABS7UC2ltW0H/A0ofVjZ7QNMQHOA3QeMUMU2K1g2WjmjHnNbRnCpp4CWp3gfIE3WeHNN0D2Bpqlf7dbBbcMwDAXQT7QD8KdewNqg0AIu4P1nqqMitZIYUch/ySH/5IteJJoR/VVJfrcn7vEH60n0qd3V9vw72Nf0q54C7Ob3a/9c4583H/0JavQA7V/QaxiH0GIuAoQYvxP7jBvJeBvEYhBjeLkavoFIuEUAyFLKnG8DO5Ut9DTAcs6cB05/AFTAJYB0RAGbSV6uAVgCaLW/yuSxnd8nArAcAeIG5lAFVEA9geU2YGzx4xIQg5D+8AQcTZvRO7CjxR7oosEIHAMmtFH4QjgqoQq4CMwQAY8B7NPutPxo8r1fsgAWmAR8ygAACVhFYDsBDHHAuAWAr9iBxFCHL/+AIT4X6FMHZAaTO0SAKrCKwPSTBHgBrF8aF4g0AJ7jAmBN0QBbzTVgQQ74BXhqgVKn4hWLAAAAAElFTkSuQmCC");
	background-size:100% 100%;
	background-repeat:no-repeat;
}
#restspeak{
	position: absolute;
	left: 458px;
	top: 160px;
	background-color: silver;
	font-size: 20px;
	border: 2px solid silver;
	border-radius: 10px;
}
#rest-options{
	font-size: 18px;
}
#chem{
	width: 256px;
	height: 256px;
	position: relative;
	background-size:100% 100%;
	background-repeat:no-repeat;
}
.fuli{
	position: relative;
	border: 2px solid;
}

.inv-item{
	width: calc(100% - 32px);
	height: 32px;
	background-size: 32px 32px;
	background-repeat: no-repeat;
	padding-left: 32px;
	font-size: 6px;
	border: 1px solid;
}
body {
	-ms-interpolation-mode: nearest-neighbor;
	image-rendering: pixelated;
	min-width: 1024px;
	min-height: 512px;
	/*overflow:hidden;*/
}
</style>
</head>
<body>

<div id="debug" style="display:none;">
<input name="debug-scene" type="radio" value="0" onchange="go_scene(this.value)"/>home
<input name="debug-scene" type="radio" value="1" onchange="go_scene(this.value)"/>medi
<input name="debug-scene" type="radio" value="2" onchange="go_scene(this.value)"/>rest
<button onclick="count=1;troll();pickup_soap()">快速捡肥皂</button>
<button onclick="debug_get_all_items()">快速获得全物品</button>
<button onclick="is_hand_rough=true;is_hand_clean=true">净手</button>
<button onclick="show_public_fuli()">显示public福利</button>
<button onclick="show_true_fuli()">显示true福利</button>
<input type="text" id="code-decoder-input"></input>
<button onclick="debug_decode_code()">解码通关密码</button>
<div id="code-decoder-result"></div>
</div>

<div id="publicfuli" class="fuli" style="display: none;">
<p>恭喜你，你可以看到金毛的福利了</p>
<p><a href="https://itty.bitty.site/#temp.html/data:text/html;charset=utf-8;bxze64,XQAAAAKEAgAAAAAAAAAeGgqG70rWjpH17/W2GQI0mlGFZRqo2+Iwm7ymYFrMqXwGgS3kcmg2o+ni/i8WHRM+5b9RQGlHN8RY7yRTF6GSXQSXaCpv0n/72oiOqKk/TEDKJKwqp/ODJ+oSIfsfFQnWzTGSrS1mobIVx/t9WgrF+sqEaFhLw0wtl8ybdeMlL5bCtNEjv3KulctuUAcIJ3PvacMQZSW63P5356q5m9sGZxsy21m2ydr95wxliz8SevZ+bjte8Nqt101TcQ7GBAScM8RNh+RB0kk2jQyjf3wu4nRLEJ86jfjqE96QFb3HPrxkqunVyuARpyMkpEumkT2YkK2nn9ZU350r37FfsMDxCiKdt5SK1OsFIZFQMaoedZ6VRIhzKeEEHbMqmuPL8EQLvyHhjOGHdhSStzfq7E3+N0MAA86ZQS2jt7yA+aO7w5gm5q+KLu0HZLrr8O5Krzevu2qzyFuBnC5cgYjvs6UtEpWYl5+v85/58U/vx6poY6fMIjNcwgptiXigz5YOH2mc/9nETKg=" id="fulilink">点击进入金毛的超简单体温生成器</a></p>
<p><button onclick="fuli_make_qrcode()">点击生成上述工具的二维码以便分享（你还是最好点这个）</button></p>
<p>制作：金毛geezmolycos，2020</p>
<p>通关用时：<span id="complete-time"></span></p>
<p>通关密码：<span id="complete-code"></span>（你可能需要问问金毛）</p>
</div>
<div id="truefuli" class="fuli" style="display: none;">
<p>金毛的真正福利（上面的是假福利，QQ空间版不显示，哈哈哈！）</p>
<p>金毛之前乱乱捏的「浑身棵体」金毛写真！</p>
<img src="data:image/png;base64,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"></img>
<a href="https://www.furaffinity.net/">点击观看更多福利</a>
<a href="https://www.jandan.net/">点击观看新鲜事</a>
</div>

<div id="public-indicator" style="display: none; background-color: black; color: white;">
PF版
</div>

<div id="home" class="scene" style="display:none;">
	<p style="display: inline-block;" >金毛的贴心小进度：</p>
	<div class="bar-border">
		<div id="bar"></div>
	</div>
	<br />
	<button id="click" class="gmbutton gm-gold" onclick="troll()"></button>
	<br />
	<button id="dropsoap" class="gmbutton gm-silver" style="display: none;" onclick="pickup_soap()">
		<div>拿起肥皂</div>
		<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgAgMAAAAOFJJnAAAADFBMVEUAAAD/9L8AAAD/fydij/qbAAAAAXRSTlMAQObYZgAAAJVJREFUGNOVzjsOwjAQRdGndMlS2M+zI0soaZDAvZUKkU0E2jSh8H6QS1ZhUUVi/OkR09wz09j4OYe5divwG8e8L4xj6eDOaOQ+HF2PjtynAv2eQhTooG+BCu1DD+7zMoKwO1qP9nQl/aIEspMJ0WwZFyVlj9Z4ZnQ2lfKWSjUzmrvUrgAEPhVP2vpftRZ09YBmxd/zBUbDO7eIG4x+AAAAAElFTkSuQmCC" />
	</button>
	<div id="chem" style="display:none">
		<img id="chem-soap" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABAAgMAAADXB5lNAAAADFBMVEUAAAD////v5LAAAADv7/HZAAAAAXRSTlMAQObYZgAAAIZJREFUOMvt0TEKAkEMhWEv+ZhqzSlsBPE+iuxpBk9hueXwnCTixiALW22zfzV8TNLkgNR/EJI/cAIKW4AJUKpf8Ilhhv7qIgFshyBAT1oCDJsDM5xNWoAbe68I2iPDmOE+w3E1kA6sDoQ4YDIoQPnAJcBIEmLQPxbSj1cNrrpLkU+Fvb2F3mYX4Q+I5L34AAAAAElFTkSuQmCC" onclick="get_chem_item()" style="display: none; position: absolute; top:0px; left:0px; width:256px; cursor: pointer;" />
	</div>
	<p id="tip" style="display: none; color: red; background-color: white; font-size: 32px;"></p>
</div>

<div id="medi" class="scene" style="display:none;">
	<div id="medi-store">
		<p id="medispeak"></p>
	</div>
	<ul id="medi-options"></ul>
</div>

<div id="rest" class="scene" style="display:none;">
	<div id="rest-store">
		<p id="restspeak"></p>
		<img id="rest-price-tag" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAHAQMAAAA77l8BAAAABlBMVEX///8AAABVwtN+AAAAG0lEQVQI12MAgvRyhtBQhvByhkRBhuflDA4MACoUBGdS16lNAAAAAElFTkSuQmCC" style="left: 380px; top: 36px; width: 64px; height: 28px; position: absolute; display: none;"/>
	</div>
	<ul id="rest-options"></ul>
</div>

<div id="invfloat" class="float" style="display: none; bottom: 0px; right: 0px;">
	<div id="inv-title" class="float-title">物品栏(可拖动)</div>
	<div id="inv" class="float-content"></div>
	
<div id="item-use-hint" style="display: none; color: red; background-color: white; font-size: 20px; max-width: 250px"></div>
</div>
<div id="mapfloat" class="float" style="display: none; bottom: 280px; right: 0px;">
	<div id="map-title" class="float-title maptitle">地图(可拖动可点击)</div>
	<div id="map" class="float-content">
		<div onclick="go_scene(0)" style="cursor: pointer; position: absolute; left: 0px; top: 38px; width: 94px; height: 134px"></div>
		<div onclick="go_scene(1)" style="cursor: pointer; position: absolute; left: 94px; top: 38px; width: 84px; height: 134px"></div>
		<div onclick="go_scene(2)" style="cursor: pointer; position: absolute; left: 178px; top: 38px; width: 77px; height: 134px"></div>
	</div>
</div>
<script>
/*
新福利：老福利结束后
出现肥皂，一拿就掉到了地上，因为手滑拿不起来。
出现小地图，出门右转药店买（偷）NaOH，酒精，饭店偷油（三油酸甘油酯）。家里进行皂化反应，制出肥皂（要等一会）。制出来之后用肥皂洗手。洗干净之后用酒精消毒（如果不消毒，按钮就被病毒侵蚀）。之后成功按按钮。
*/
var DEBUG = false;
var PUBLICFULI = false;
if (PUBLICFULI){ // show public indicator
	document.getElementById("public-indicator").style.display = "inline-block";
}

if (!DEBUG){
	var count = 88;
} else {
	var count = 3;
	document.getElementById("debug").style.display = "block";
}
var max_count = count - 1;
var button = document.getElementById("click");
var bar = document.getElementById("bar");
var tip = document.getElementById("tip");
var tipTimeout = null;
var drop_soap_unlocked = false;
var is_hand_rough = false;
var is_hand_clean = false;
var is_button_infected = false;
var start_time = Math.floor(new Date().getTime()/1000);

// inventory
var invfloat = document.getElementById('invfloat');

var mapfloat = document.getElementById('mapfloat');

function countdown(){
	count --;
	button.innerText = "点我"+count+"下之后就可以获取福利了！";
	bar.style.width = (200 - (count/max_count*200)) + "px";
	if (count == 0){ // you win
		if (PUBLICFULI){
			show_public_fuli();
		} else { // true fuli
			show_true_fuli();
		}
	}
}
countdown();

function calculate_code(start_time, end_time){
	var diff = end_time - start_time;
	var key = Math.floor(Math.random()*65536);
	var codearr = [((end_time>>16) & 0xffff) ^ key, (end_time & 0xffff) ^ key, (diff & 0xffff) ^ key, key];
	var codestr = "";
	for (var i=0;i<codearr.length;i++){
		for (var h=12;h>=0;h-=4){
			codestr += "0123456789ABCDEF"[(codearr[i]>>h) & 0xf];
		}
	}
	return codestr;
}

function decode_code(code){
	var codearr = [0,0,0,0];
	for (var i=0;i<4;i++){
		codearr[i] = Number.parseInt(code.slice(i*4, i*4+4), 16);
	}
	codearr[0] ^= codearr[3];
	codearr[1] ^= codearr[3];
	codearr[2] ^= codearr[3];
	var end_time = codearr[0] << 16 | codearr[1];
	return [end_time - codearr[2], end_time];
}

function debug_decode_code(){
	var code = document.getElementById("code-decoder-input").value;
	var r = decode_code(code);
	document.getElementById("code-decoder-result").innerText = "开始时间:"+new Date(r[0]*1000).toLocaleString()+", 用时"+(r[1] - r[0])+"秒, 结束时间:"+new Date(r[1]*1000).toLocaleString();
}

function show_public_fuli(){
	var end_time = Math.floor(new Date().getTime()/1000);
	var diff = end_time - start_time;
	var codestr = calculate_code(start_time, end_time);
	document.getElementById("complete-code").innerText = codestr;
	document.getElementById("complete-time").innerText = Math.floor(diff / 60) + "分钟" + Math.floor(diff % 60) + "秒";
	document.getElementById("publicfuli").style.display = "block";
}

function show_true_fuli(){
	show_public_fuli();
	document.getElementById("truefuli").style.display = "block";
}

function fuli_make_qrcode(){
	var link = document.getElementById("fulilink").href;
	window.open("https://zxing.org/w/chart?cht=qr&chs=548x548&chld=L|1&choe=UTF-8&chl="+encodeURIComponent(link));
}

function repos(){
	var maxy = window.innerHeight;
	var maxx = window.innerWidth;
	var amaxy = maxy - button.offsetHeight;
	var amaxx = maxx - button.offsetWidth;
	var x = Math.floor(Math.random() * amaxx);
	var y = Math.floor(Math.random() * amaxy);
	button.style.top = y + "px";
	button.style.left = x + "px";
}

function showTip(text, delay){
	tip.innerText = text;
	tip.style.display = "block";
	clearTimeout(tipTimeout);
	tipTimeout = null;
	if (delay != 0){
		tipTimeout = setTimeout(function (){
			tip.style.display = "none";
		}, delay);
	}
}

function showsoap(){
	var soap = document.getElementById("dropsoap");
	soap.style.display = "block";
	invfloat.style.display = "block";
}

function troll(){
	if (count <= 0){
		//do nothing
	} else if (count == 1){
		button.style.position = "absolute";
		if (is_button_infected){
			showTip("哎呀，按钮中病毒了，不能用了，你最好是重开一局", 0);
			return;
		}
		if (is_hand_rough && !is_hand_clean){
			is_button_infected = true;
			button.style.backgroundColor = "#FF00FF";
			showTip("你点上了按钮，但是你手上的病毒使得按钮无法使用了。", 0);
			return;
		}
		if (is_hand_rough && is_hand_clean){
			countdown();
			return;
		}
		repos();
		
		if (!drop_soap_unlocked){
			showTip("哎呀，手滑了没点上！用肥皂洗洗手吧。（寻找肥皂中，请稍等）", 2000);
			if (!DEBUG){
				setTimeout(showsoap, 5000);
			} else {
				showsoap();
			}
			
			drop_soap_unlocked = true;
		} else {
			showTip("哎呀，手滑了没点上！用肥皂洗洗手吧", 2000);
		}
	} else { // count >= 2
		countdown();
	}
}

function pickup_soap(){
	showTip("哎呀，你的手太滑，把肥皂弄掉了！想想还有什么办法。", 0);
	var soap = document.getElementById("dropsoap");
	soap.style.display = "none";
	mapfloat.style.display = "block";
}

var scene_home = document.getElementById("home");
var scene_medi = document.getElementById("medi");
var scene_rest = document.getElementById("rest");

var current_scene = null;

function start_scene(){
	//document.getElementById("readme").style.display = "none"; //moved to the loader
	go_scene(0);
}

function go_scene(n){
	current_scene = n;
	var a = [scene_home, scene_medi, scene_rest];
	for (var i = 0; i < a.length; i++){
		if (i == n){
			a[i].style.display = "block";
		} else {
			a[i].style.display = "none";
		}
	}
	if (n == 1){ // medi
		go_speak_scene(medi_scenes, medi_speak_elem, medi_options_elem, "init_start", medi_check_get_item);
	} else if (n == 2){ //rest
		go_speak_scene(rest_scenes, rest_speak_elem, rest_options_elem, "init_start", rest_check_get_item);
	}
}

// medicine shop

var medi_speak_elem = document.getElementById("medispeak");
var medi_options_elem = document.getElementById("medi-options");

var medi_start_options = [
	["zyw", "我要枣药丸。"],
	["nozyw", "谢谢，我不要枣药丸。"],
	["intro", "你能介绍一下你自己吗？"],
	["more", "除了枣药丸，你们还卖什么吗？"],
	["oil", "你们这里有油吗？"],
]

var medi_scenes = {
	"init_start":["您好，这里是枣药丸药店，请问你要吃枣药丸吗？",
		medi_start_options
	],
	"start":["请问你还要些什么呢？",
		medi_start_options
	],
	"zyw":["好，一个枣药丸87871487像素。",
		[
			["zyw2", "我没有那么多钱"],
			["zyw3", "好，这是87871487像素。"],
		],
	],
	"zyw2":["那你还买什么枣药丸？",
		[
			["start", "..."],
		],
	],
	"zyw3":["你骗人，你根本没有那么多钱。",
		[
			["start", "..."],
		],
	],
	"nozyw":["好的...",
		[
			["start", "..."],
		],
	],
	"intro":["虽然你这样说很奇怪，但是我还是介绍一下好了。",
		[
			["intro2", "..."],
		],
	],
	"intro2":["我是枣药丸药店的店长，我叫斐里斯·凯特斯，请多多指教~",
		[
			["start", "..."],
		],
	],
	"more":["嗯，我们还卖氢氧化钠，无水乙醇，一个六边形里面套个圈外面连一个-CH3三个-NO2的化合物（开玩笑的），你想要来一点什么吗？",
		[
			["naoh", "来一点氢氧化钠吧"],
			["c2h5oh", "来一点无水乙醇吧"],
			["tnt", "来一点最后一个吧"],
		],
	],
	"tnt":["啊，开玩笑的啦，我们不卖那个。",
		[
			["start","..."],
		],
	],
	"naoh":["好的，一瓶200像素。",
		[
			["start","(付钱)..."],
		],
	],
	"c2h5oh":["好的，一瓶100像素。",
		[
			["start","(付钱)..."],
		],
	],
	"oil":["油？我是卖药的，不是卖油的。",
		[
			["start","..."],
		],
	]
	
}

function medi_check_get_item(scene, option){
	if (scene == "naoh"){
		give_item("naoh");
	} else if (scene == "c2h5oh"){
		give_item("c2h5oh");
	}
}

//restaurant

var rest_speak_elem = document.getElementById("restspeak");
var rest_options_elem = document.getElementById("rest-options");

var rest_start_options = [
	["zyw", "我要吃枣药丸。"],
	["lp", "来一份凉皮。"],
	["bf", "来一瓶冰峰。"],
	["jm", "来一份夹馍。"],
	["xf", "来一碗稀饭。"],
	["mhtc", "来一份三秦梦幻套餐。"],
	["intro", "你能介绍一下你自己吗？"],
	["oil", "你们这里有油吗？"],
]

var rest_scenes = {
	"init_start":["您好，这里是三秦梦幻餐馆，请问你要吃些什么吗？",
		rest_start_options
	],
	"start":["请问你还要些什么呢？",
		rest_start_options
	],
	"zyw":["要吃枣药丸请到隔壁药店！",
		[
			["start", "..."],
		],
	],
	"lp":["凉皮140像素！",
		[
			["start", "(付钱)..."],
		],
	],
	"bf":["冰峰40像素！",
		[
			["start", "(付钱)..."],
		],
	],
	"jm":["夹馍160像素！",
		[
			["start", "(付钱)..."],
		],
	],
	"xf":["稀饭60像素！",
		[
			["start", "(付钱)..."],
		],
	],
	"mhtc":["三秦梦幻套餐999像素！",
		[
			["start", "(付钱)..."],
			["mhtc2", "什么？你们牌子上写的不是320像素吗？"],
			["start", "哦，我不买了"],
		],
	],
	"mhtc2":["啥，你眼花了吧！",
		[
			["start", "好吧，那就999像素吧，(付钱)..."],
			["start", "那我不买了"],
		],
	],
	"intro":["突然被你这样问还真奇怪...",
		[
			["intro2", "..."],
		],
	],
	"intro2":["我是三秦梦幻餐馆的老板，我叫凯尼斯·鲁普斯~",
		[
			["start", "..."],
		],
	],
	"oil":["你为什么想要油，还来我们这里买...",
		[
			["oil2", "..."],
			["start", "我突然不想要了"],
		],
	],
	"oil2":["按一瓶300像素卖给你好了。",
		[
			["start", "...(也许我可以在我家中用它做些什么)"],
		],
	],
}

function rest_check_get_item(scene, option){
	if (scene == "lp"){
		give_item("lp");
	} else if (scene == "bf"){
		give_item("bf");
	} else if (scene == "jm"){
		give_item("jm");
	} else if (scene == "xf"){
		give_item("xf");
	} else if (scene == "mhtc" && option == 0 || scene == "mhtc2" && option == 0){
		give_item("lp"); // san qin meng huan tao can
		give_item("bf");
		give_item("jm");
	} else if (scene == "mhtc" && option == 1){
		document.getElementById("rest-price-tag").style.display = "block";
		rest_scenes["mhtc"][1].pop(1);
	} else if (scene == "oil2"){
		give_item("oil");
	}
	
}

var one_by_one_map = {};
function one_by_one(sentence, elem, count)
{
	delete one_by_one_map[elem];
	var screen = sentence.substr(0, count);
	elem.innerText = screen;
	if (count > sentence.length)
		return;
	one_by_one_map[elem] = setTimeout(function (){one_by_one(sentence, elem, count+1)}, 50);
}

function clear_one_by_one(elem){
	clearTimeout(one_by_one_map[elem]);
	delete one_by_one_map[elem];
}

function go_speak_scene(scene_dict, speak_elem, options_elem, scene_name, check_item){
	medi_current_scene = scene_name;
	var scene = scene_dict[scene_name];
	var speak = scene[0];
	clear_one_by_one(speak_elem);
	one_by_one(speak, speak_elem, 0);
	var actions = scene[1];
	options_elem.textContent = "";
	for (var ai=0;ai<actions.length;ai++){
		var button_to_add = document.createElement("button");
		button_to_add.classList = "gmbutton gm-silver medi-options"
		button_to_add.innerText = actions[ai][1];
		button_to_add.onclick = (function(ai){
			return function(){
				check_item(scene_name, ai);
				go_speak_scene(scene_dict, speak_elem, options_elem, actions[ai][0], check_item);
			}
		})(ai); // small hack to make ai independent
		var li = document.createElement("li");
		li.appendChild(button_to_add);
		options_elem.appendChild(li);
	}
}

//chemistry

var chem_stage = 0;
var chem_elem = document.getElementById("chem");
function render_chem(){
	chem_elem.style.display = "block";
	chem_elem.style.backgroundImage = "url("+["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABAAgMAAADXB5lNAAAACVBMVEX///8AAAC5eleUATnpAAAA9klEQVQ4y8XSMW7FIAwG4N8SXjp5IJfoKegNPIT7vbHqKYtrg0mWtm95iZKYT8YWEPzt4t77BQSgfm6ggFFb4DNKwoiG8A5Wg7EDwOcNUF4Oegd5FvgOlFD+DX1eLcbgyNCZSRHUBD9Nnkuj3v3wvMhhH8P+4VC8BSAMh1zBBtWDBMumhBi0X0ES3r8eV8Ad6Ad4h097b/D2yDZiyUUuQOogC1DqBSoKe7kARaGEBmqoOFdfG0HAbQGpAWT2beyFSgBBHXjCbGgz1WDt6aGQyIhDaw5e+jQMqFGEYyss6DrCOgEKPUbYFsi4TwvmU3F0oCbw+uUI37zDKBqXdKXQAAAAAElFTkSuQmCC", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABAAgMAAADXB5lNAAAADFBMVEX///8AAAD/yQ65elfywsSsAAABCklEQVQ4y8XSPXLEIAwF4McMShsK3OQyITegQDfI0bJFcro9QGYS3gqD7CbZauU/8Y2RPGD8L0RVD5CAoM1BBUhlgs2IC3rWRTywhsABW7UTID4c9AwvN2kOvrTHuwfGxxkuZ/hc8HQ36B5ljCHjjQpG6OeA7ODCvZF934KqbZ4V2fgg6ptBtBZAEhisn8BBZuJBWMaBDcqfkBa8/lyPgDOEG4iHb94dPF9Xm8SXYzpAqAZpAmI+QEYUKzegIoYFhUuX0WZfjpAgZUKoBJ7Wt4gVigMCqoHssDfkzEqYa7pVJILMTSsGVroRB+RRRMZSMNHa0zyAtevW0zIh9aMx2a+MTXmfIMqwz/4FOWFQEP9au1EAAAAASUVORK5CYII=", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABABAMAAABYR2ztAAAAD1BMVEX///8AAAD/yQ7Dw8O5eleaw263AAABNklEQVRIx+WTzVHFMAyELaCA3fcqIGkA4gY40H9N2JEzsiM5OcCNncmf9HmleOT0h6Jqmpf2IInYoGNDZiiAAEDD9BED1gNTCFg1xIDpHwPkDSCLIYyBZWHTYwKYbgHeAe8p0KMk1u0ayDmvW54Ca656LdfmARY9s+qZP0nC7SKXury8qAPdmZElf1T//LL3IPBAyXcHkOdTJcyZFh0tOHzsQgFMYKdWlZcDIrNxElgkdmBsAe+NXwMSAW/fRTNAdQeIAYkz4MssAqDUiLZXzBZyAQhTD4gHUgUwBQS7L6fbRw1GTUAN2o1wNVrqiBEBIOy7OdeovsMijIC4QeIJcL8mHOfPz6SQ6mcO0Vgb0FvAQANs4cGy71KOAEnb1hFQgrV9aMYBclidihsAPfn67oAimvqZ+QHZsiSG7T3sXAAAAABJRU5ErkJggg==", "data:image/gif;base64,R0lGODlhQABAAKIAAAAAALl6V+0cJP/JDsPDw////wAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/h1CdWlsdCB3aXRoIEdJRiBNb3ZpZSBHZWFyIDQuMAAh+QQECgAGACwAAAAAQABAAAAD/li63P4wykmrvViCzXvPoAVUHheeyoaWqFh6YjG21Bx9t0pPNv8uup1mhRMOdz3jI3liKhlOUPQpE06f10vWuCVRId3ad2kdO4qhMHIwQNeCZiB73n7ZAe14A0/v+/95enKAhH5wcXyFimxqNIl9BASLjIKDc5GYkpEDm4aVKWyZopEFo52NGHemqwCZdo4me3yZpaQNopRAqFA8obarBAWeULspvZwKmCl3bjLFzjmtmM1az9TVzDqHqc7ZHgLgsWS6LWHg5+g8WBXgCujn6lzsC+czAmJlFO28Bff4jhb29Xvn70Y+dvsKCjQIsEKAhxDTeWl4ASJELUhSWXyYieqZMS0bOWJcwa2ARSlNOn7cZY0EnBnFYk7kt+1fyRzjoGVgqSFKD543l/hMIm6mUWJHztTMebRbPIY2ny7r9mpLlzA/sXorCiaGzqBglk7FF/Mqtatjd6rxabSsVbZRxSYNO7errLBorsitIhXp3WUwodZluoewU8OCEafVBYPuyMSytr7aySABACH5BAQKAAYALBgAIAAOAAgAAAMcCLqs9fCJSIu4eNZr+eRQ9mGR2GkUCBZB66JQAgAh+QQECgAGACwYACEADgAHAAADFViqwr1ONCkXrfeVzGHMXhQqQWmOCQA7"][chem_stage]+")";
}

function complete_chem(){
	document.getElementById("chem-soap").style.display = "block";
}

function get_chem_item(){
	chem_elem.style.display = "none";
	chem_stage = 0;
	give_item("soap");
	showTip("获得肥皂！", 1000);
}

function do_chem(){
	showTip("似乎烧杯中开始发生了什么反应...也许等一等可以让它反应充分", 3000);
	setTimeout(complete_chem, 15000);
}

//inventory
var inv_elem = document.getElementById("inv");

var item_desc = {
	"naoh":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgAgMAAAAOFJJnAAAADFBMVEUAAAD///8AAAB/MwBjHT1WAAAAAXRSTlMAQObYZgAAAIJJREFUGNNjAAL7//8PMIAA////DKgM5v//wLTWqlXrVgBprgVMq1YxLWBgYAJK/WFQQGEAAQkMoEEgc7RWrQwNTQAyVENDIYy0yNCsmQtAjJmhqRBG5srUWWBGZCdUJHIVRE0qVBdXamgW2EDOrFVLwSKcQAkcDC4Yg2kVCDQw4AYAkf88thka5ZYAAAAASUVORK5CYII=","氢氧化钠（分析纯）"],
	"c2h5oh":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAD1BMVEUAAACAgIAAAAD/agCAgIC+ZXA4AAAAAnRSTlMAVW2SaEMAAACASURBVCjPrY3RDYAwCERJN4AJ4OIG3cC4/0xSq+H6oz++jwZe7qjc9N6F6Mm34L0hcRaSgIRPWwEvLRSuK5iU8Gv26szR2yIa3JcbabiCfCix7cmx7VUJg1qYPIRevAlAswRKmGqARSoYVUyHoESkMDqKsYNvAFh+wSDuClv5ixPx7BSTR4GYqgAAAABJRU5ErkJggg==","无水乙醇（分析纯）"],
	"soap":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgAgMAAAAOFJJnAAAADFBMVEUAAAD/9L8AAAD/fydij/qbAAAAAXRSTlMAQObYZgAAAJVJREFUGNOVzjsOwjAQRdGndMlS2M+zI0soaZDAvZUKkU0E2jSh8H6QS1ZhUUVi/OkR09wz09j4OYe5divwG8e8L4xj6eDOaOQ+HF2PjtynAv2eQhTooG+BCu1DD+7zMoKwO1qP9nQl/aIEspMJ0WwZFyVlj9Z4ZnQ2lfKWSjUzmrvUrgAEPhVP2vpftRZ09YBmxd/zBUbDO7eIG4x+AAAAAElFTkSuQmCC","肥皂"],
	"oil":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAG1BMVEUAAAD/2AAAAAAiHABPQgAuJgA9MwA5MAAVEQD2A7JpAAAAAXRSTlMAQObYZgAAAIpJREFUKM+lzzEOwjAQBMDofrBgQXscHwAiJFokFGqK/CD/fwNWtDn7LCVNtvKObgt3KzEzDZBbBGtB2oloF0XnWYnxygdkv9dsluMDFnHg2IE9gmgNLAWEoPWED04auByBA3IWuAOPV/8EbgXGhFTD7zRMQ4CEd9qG82f6VjBiTgHsBrn2DP8S8wdCOxaD7adDmAAAAABJRU5ErkJggg==","三油酸甘油酯"],
	"lp":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAFVBMVEUAAAAAAAD/////agD/9L//AAAAfw7H3vhAAAAAAXRSTlMAQObYZgAAAJNJREFUKM/VkMENg0AMBEMHGCqADtA6eSN5jwY4aOCg/xYSdL7cI4+8md+O17Lkx81p5IL85h4wpUjrQvBKNABSCodxOXcsnLMA+TQNEWiLSIymWxXLgQAEJWdvnLAYuU65Icqw0zZdJ7/aq63KDy66ocdFmsTFKJmu9ZWx4KL5EZ3nIYu6I/UdOXvBjfi8mDr+yxt9eCB/UL8vWAAAAABJRU5ErkJggg==","凉皮"],
	"bf":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAElBMVEUAAAD/agAAAAD///8AlP//AAAbu1bLAAAAAXRSTlMAQObYZgAAAFdJREFUKM9jIBa4uDigCigxKaAKKDCgCgDllVB1AMVQBBQFBYUUkHUABQRR9IAEFFAFDA1RBYSFhRXwaWFSNA0MQhEAKhBiQBEwMTFiQFcxggWUgADKBgBrRAt6o3MZ0wAAAABJRU5ErkJggg==","冰峰"],
	"jm":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgAgMAAAAOFJJnAAAADFBMVEUAAAD/9L9/MwD/4W0HsYjDAAAAAXRSTlMAQObYZgAAAGtJREFUGNNjoAEQDQ0NBdGMoUAQABH4/xckBKSvhn8FMUCg1AHIKAWxHBiYQuuhDNHQ/0DFQKmVIAEQYxWIDktgYJoFEopqAIqsmhkatQoopbVq9f9fIAbXKiBYCmQwZGWtmhoCpMGWUOwXAJfMK//r5R+nAAAAAElFTkSuQmCC","肉夹馍"],
	"xf":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAD1BMVEUAAAD///8AAAD/2AD/9L9KvPNLAAAAAXRSTlMAQObYZgAAAHRJREFUKM/VjNENgCAMBRucwE4AzwWIdQPYfyZpMZQQE7+9j4ZejtKfCHCiCpubiOTnnWJbrlrayAQVaGuVWqxRwccloqJkWLED0jlBJnbGA3fhvAusIkwCq4gm0iLIBXcR5hPjjweesAWeADQAEkN7x9dPbm+IGFFm62/OAAAAAElFTkSuQmCC","稀饭"],
}
var item_list = [];

var usehintTimeout = null;
var item_use_hint_elem = document.getElementById("item-use-hint");
function show_item_use_hint(text, delay){
	item_use_hint_elem.innerText = text;
	item_use_hint_elem.style.display = "block";
	clearTimeout(usehintTimeout);
	usehintTimeout = null;
	if (delay != 0){
		usehintTimeout = setTimeout(function (){
			item_use_hint_elem.style.display = "none";
		}, delay);
	}
}

function give_item(name){
	item_list.push(name);
	render_items();
}

function debug_get_all_items(){
	var l = Object.keys(item_desc);
	for (var i=0;i<l.length;i++){
		give_item(l[i]);
	}
}

function delete_item(i){
	item_list.splice(i, 1);
	render_items();
}
function use_item(i){
	item_name = item_list[i];
	if (item_name == "lp"){
		is_hand_clean = false;
		show_item_use_hint("你吃了凉皮，你感觉很辣。", 3000);
		document.body.style.backgroundColor = "#F08080";
		delete_item(i);
	} else if (item_name == "jm"){
		is_hand_clean = false;
		show_item_use_hint("你吃了夹馍，你感觉很饱。", 3000);
		delete_item(i);
	} else if (item_name == "xf"){
		is_hand_clean = false;
		show_item_use_hint("你喝了稀饭。", 3000);
		delete_item(i);
	} else if (item_name == "bf"){
		is_hand_clean = false;
		show_item_use_hint("你喝了冰峰，你感觉很爽。", 3000);
		document.body.style.backgroundColor = "";
		delete_item(i);
	} else if (item_name == "oil"){
		if (current_scene == 0 && chem_stage == 0){
			is_hand_clean = false;
			chem_stage ++;
			render_chem();
			show_item_use_hint("你把油放入了烧杯。", 3000);
			delete_item(i);
		} else {
			show_item_use_hint("你不知道如何使用油。", 3000)
		}
	} else if (item_name == "naoh"){
		if (current_scene == 0 && chem_stage == 1){
			is_hand_clean = false;
			chem_stage ++;
			render_chem();
			show_item_use_hint("你把氢氧化钠放入了烧杯。", 3000);
			delete_item(i);
		} else {
			show_item_use_hint("你不知道如何使用氢氧化钠。", 3000)
		}
	} else if (item_name == "naoh"){
		if (current_scene == 0 && chem_stage == 1){
			is_hand_clean = false;
			chem_stage ++;
			render_chem();
			show_item_use_hint("你把氢氧化钠放入了烧杯。", 3000);
			delete_item(i);
		} else {
			show_item_use_hint("你不知道如何使用氢氧化钠。", 3000)
		}
	} else if (item_name == "c2h5oh"){
		if (current_scene == 0 && chem_stage == 2){
			chem_stage ++;
			render_chem();
			show_item_use_hint("你把乙醇放入了酒精灯。", 3000);
			do_chem();
			delete_item(i);
		} else {
			// clean hand
			is_hand_clean = true;
			show_item_use_hint("你用酒精给手消了毒， 你最好不要碰什么东西了。", 3000);
			delete_item(i);
		}
	} else if (item_name == "soap"){
		is_hand_rough = true;
		is_hand_clean = false;
		show_item_use_hint("你用肥皂洗了手，但是你怀疑你的手上有病毒。", 3000);
		delete_item(i);
	}
}

function render_items(){
	inv_elem.textContent = "";
	for (var i=0;i<item_list.length;i++){
		var item_name = item_list[i];
		var item_img = item_desc[item_name][0], item_text = item_desc[item_name][1];
		var item_elem = document.createElement("div");
		item_elem.classList = "inv-item";
		item_elem.innerText = item_text;
		item_elem.style.backgroundImage = "url(" + item_img + ")";
		item_elem.onclick = (function(i){
			return function(){
				use_item(i);
			}
		})(i);
		inv_elem.appendChild(item_elem);
	}
}

var draggingObj=null; // dragging inventory
var diffX = 0, diffY = 0;

function down(e){
	if (e.target.className.indexOf('float')!=-1){
		draggingObj=e.target.offsetParent;
		diffX=(e.clientX || e.touches[0].clientX)-draggingObj.offsetLeft;
		diffY=(e.clientY || e.touches[0].clientY)-draggingObj.offsetTop;
		draggingObj.style.zIndex = 101;
	}
}

function move(e){
    if(draggingObj){
        draggingObj.style.left=(e.clientX || e.touches[0].clientX) - diffX +'px';
        draggingObj.style.top=(e.clientY || e.touches[0].clientY) - diffY +'px';
		draggingObj.style.bottom = "";
		draggingObj.style.right = "";
    }
}

function up(e){
	if (draggingObj){
		draggingObj.style.zIndex = 100;
		draggingObj=null;
	}
}

document.addEventListener('mousedown',down);
document.addEventListener('touchstart',down);
document.addEventListener('mousemove',move);
document.addEventListener('touchmove',move);
document.addEventListener('mouseup',up);
document.addEventListener('touchend',up);

start_scene();

</script>
</body>
</html>